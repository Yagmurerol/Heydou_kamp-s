@{
    ViewData["Title"] = "HeyDOU AI";
}

<div class="container mx-auto max-w-3xl mt-10">
    <h1 class="text-3xl font-bold text-center mb-6">🎓 HeyDOU Öğrenci Asistanı</h1>

    <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-6 space-y-4">
        <textarea id="question"
                  class="w-full border rounded-lg p-3 focus:ring focus:ring-primary"
                  rows="3"
                  placeholder="HeyDOU'ya soru sor... örn: Bu hafta yemekte ne var?"></textarea>

        <button onclick="sendQuestion()"
                class="w-full bg-primary text-white p-3 rounded-lg font-bold">
            Sor
        </button>

        <div id="answer" class="mt-4 p-4 rounded-lg bg-gray-50 dark:bg-gray-700 text-sm"></div>
    </div>
</div>

<script>
    async function sendQuestion() {

        const question = document.getElementById("question").value;
        const answerDiv = document.getElementById("answer");

        if (!question.trim()) {
            alert("Lütfen soru gir");
            return;
        }

        answerDiv.innerHTML = "🤖 Düşünüyorum...";

        const response = await fetch("/api/ai/ask", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ question: question })
        });

        const data = await response.text();

        answerDiv.innerHTML = data;

        // basit yönlendirme
        if (data.includes("Yemekhane")) {
            answerDiv.innerHTML += `<br><a class="text-primary underline" href="/Yemekhane">Yemekhaneye git</a>`;
        }

        if (data.includes("Akademik")) {
            answerDiv.innerHTML += `<br><a class="text-primary underline" href="/AkademikTakvim">Takvime git</a>`;
        }

        if (data.includes("Anket")) {
            answerDiv.innerHTML += `<br><a class="text-primary underline" href="/Anket/Create">Anketlere git</a>`;
        }
    }
</script>
